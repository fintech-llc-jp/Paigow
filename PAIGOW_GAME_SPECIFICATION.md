# 牌九（パイゴウ）カジノゲーム仕様書

## 1. ゲーム概要

### 1.1 基本情報
- **ゲーム名**: 牌九（パイゴウ）
- **プレイヤー数**: 1人のディーラー（親）+ 最大7人のプレイヤー
- **牌の数**: 32枚（天九牌）
- **技術スタック**: React + TypeScript

### 1.2 ゲーム目的
各プレイヤーは配られた4枚の牌を2組（各2枚）に分け、ディーラーと対戦。両方の組でディーラーに勝利することを目指す。

## 2. 天九牌仕様

### 2.1 牌の構成（32枚）

#### 文牌（22枚 - 11種類×2枚）
| 牌名 | 点数 | 説明 |
|------|------|------|
| 天牌 | 12 | 最高位の牌 |
| 地牌 | 2 | 2つの点 |
| 人牌 | 8 | 人を表す |
| 和牌 | 4 | 和を表す |
| 梅牌 | 10 | 梅の花 |
| 長牌 | 6 | 長三 |
| 板凳 | 4 | 板凳 |
| 斧頭 | 11 | 斧頭 |
| 紅頭 | 10 | 紅頭十 |
| 高脚 | 6 | 高脚七 |
| 零霖 | 6 | 零霖 |

#### 武牌（10枚 - 2種類）
| 牌名 | 点数 | 枚数 | 説明 |
|------|------|------|------|
| 丁三 | 3 | 2枚 | 特殊牌（3または6として使用可能） |
| 二四 | 6 | 2枚 | 特殊牌（3または6として使用可能） |
| 幺二 | 3 | 2枚 | 1と2の組み合わせ |
| 二一 | 3 | 2枚 | 2と1の組み合わせ |
| 三六 | 9 | 2枚 | 3と6の組み合わせ |

### 2.2 牌のデザイン仕様

#### 牌のサイズ
- 幅: 60px
- 高さ: 90px
- 角の丸み: 8px

#### 色彩
- 背景色: #F5F5DC (ベージュ)
- 点の色: #000000 (黒)
- 特殊点の色: #DC143C (赤) - 1の点と4の点
- 枠線: #8B4513 (茶色) 2px

#### 点の配置
各牌は骨牌（ドミノ）のような点の配置で表現

## 3. 役の強さ

### 3.1 特殊役（ペア）
1. **至尊宝** - 丁三と二四のペア（最強）
2. **双天** - 天牌のペア
3. **双地** - 地牌のペア
4. **双人** - 人牌のペア
5. **双和** - 和牌のペア
6. **双梅** - 梅牌のペア
7. **双長** - 長牌のペア
8. **双板凳** - 板凳のペア
9. **双斧頭** - 斧頭のペア
10. **双紅頭** - 紅頭のペア
11. **双高脚** - 高脚のペア
12. **双零霖** - 零霖のペア

### 3.2 通常の点数計算
- 2枚の牌の点数の合計を10で割った余り
- 9が最強、0が最弱

## 4. テーブルレイアウト仕様

### 4.1 テーブルデザイン
- **形状**: 半円形
- **色**: 濃い緑色 (#0F5132)
- **サイズ**: 1200px × 800px
- **枠線**: 金色 (#FFD700) 4px

### 4.2 プレイヤーポジション
- **ディーラー位置**: テーブル上部中央
- **プレイヤー位置**: 最大7席（弧状に配置）
- **各席のサイズ**: 150px × 100px

### 4.3 牌配置エリア
- **プレイヤー手札**: 各席の前方
- **組み分けエリア**: 2つの枠（上段・下段）
- **ディーラー牌**: テーブル上部

### 4.4 UI要素
- **ベットエリア**: 各席の前方
- **アクションボタン**: 画面下部
- **チップ**: 右側に配置
- **ゲーム情報**: 左上に配置

## 5. ゲームフロー

### 5.1 ベット段階
1. プレイヤーがベット額を選択
2. "Deal"ボタンで次の段階へ

### 5.2 配牌段階
1. 各プレイヤーに4枚の牌を配布
2. ディーラーに4枚の牌を配布（裏向き）

### 5.3 組み分け段階
1. プレイヤーは4枚の牌を2組に分ける
2. 上段（High Hand）と下段（Low Hand）に配置
3. 一般的に強い組み合わせを上段に配置

### 5.4 比較段階
1. ディーラーが牌を公開し、2組に分ける
2. プレイヤーの上段・下段それぞれとディーラーを比較
3. 勝敗判定

### 5.5 勝敗判定
- **プレイヤー勝利**: 上段・下段両方でディーラーに勝利
- **ディーラー勝利**: 上段・下段両方でプレイヤーに勝利
- **プッシュ**: 上段・下段で1勝1敗、または両方引き分け
- **注意**: 同点の場合はディーラーの勝ち

## 6. React + TypeScript実装仕様

### 6.1 コンポーネント構成
```
PaigowGame/
├── components/
│   ├── GameTable.tsx           # メインテーブル
│   ├── Tile.tsx               # 牌コンポーネント
│   ├── PlayerSeat.tsx         # プレイヤー席
│   ├── DealerArea.tsx         # ディーラーエリア
│   ├── BettingArea.tsx        # ベットエリア
│   ├── HandArea.tsx           # 手札エリア
│   └── GameControls.tsx       # ゲームコントロール
├── hooks/
│   ├── useGameState.ts        # ゲーム状態管理
│   ├── useTileLogic.ts        # 牌ロジック
│   └── useBetting.ts          # ベット管理
├── types/
│   ├── Tile.ts                # 牌の型定義
│   ├── Game.ts                # ゲームの型定義
│   └── Player.ts              # プレイヤーの型定義
├── utils/
│   ├── tileUtils.ts           # 牌ユーティリティ
│   ├── handEvaluator.ts       # 手札評価
│   └── gameLogic.ts           # ゲームロジック
└── constants/
    ├── tiles.ts               # 牌定数
    └── gameRules.ts           # ゲームルール定数
```

### 6.2 主要な型定義

#### Tile型
```typescript
interface Tile {
  id: string;
  name: string;
  dots: number;
  type: 'civil' | 'military';
  value: number;
  rank: number;
  redDots?: boolean;
}
```

#### GameState型
```typescript
interface GameState {
  phase: 'betting' | 'dealing' | 'arranging' | 'comparing' | 'result';
  players: Player[];
  dealer: DealerHand;
  deck: Tile[];
  currentPlayer: number;
  pot: number;
}
```

#### Player型
```typescript
interface Player {
  id: string;
  name: string;
  chips: number;
  currentBet: number;
  hand: Tile[];
  highHand: Tile[];
  lowHand: Tile[];
  isActive: boolean;
}
```

### 6.3 状態管理
- **useGameState**: ゲーム全体の状態管理
- **Redux Toolkit** または **Zustand** の使用を推奨
- **WebSocket** による将来的なマルチプレイヤー対応

### 6.4 アニメーション
- **Framer Motion** を使用
- 牌の配布アニメーション
- 勝敗結果の表示アニメーション
- スムーズなUI遷移

### 6.5 レスポンシブデザイン
- **Desktop**: 1200px以上
- **Tablet**: 768px - 1199px
- **Mobile**: 768px未満（縦画面での簡易版）

## 7. 技術要件

### 7.1 必須パッケージ
- React 18+
- TypeScript 4.5+
- styled-components または Tailwind CSS
- Framer Motion
- React Query（API通信用）

### 7.2 推奨パッケージ
- Zustand（状態管理）
- React Hook Form（フォーム管理）
- React Hot Toast（通知）
- Lodash（ユーティリティ）

### 7.3 パフォーマンス要件
- 牌の描画: 60fps
- アニメーション: スムーズな動作
- メモリ使用量: 100MB以下
- 初期ロード時間: 3秒以内

## 8. 開発フェーズ

### フェーズ1: 基本実装
- 牌とテーブルのレンダリング
- 基本的なゲームフロー
- 手札の組み分け機能

### フェーズ2: ゲームロジック
- 勝敗判定システム
- 役の評価システム
- ベットシステム

### フェーズ3: UI/UX改善
- アニメーション追加
- レスポンシブデザイン
- サウンドエフェクト

### フェーズ4: 高度な機能
- マルチプレイヤー対応
- 統計機能
- 設定カスタマイズ

この仕様書に基づいて、本格的なカジノスタイルの牌九ゲームを実装できます。